{% extends "base.html" %}

{% block title %}System Status - ADCC Analysis Engine{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">
            <i class="fas fa-heartbeat"></i> System Status
        </h1>
        <p class="lead">Monitor system health and performance.</p>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-server"></i> System Health</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-success" id="systemStatus">Online</h3>
                            <p class="text-muted">System Status</p>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-info" id="uptime">0h 0m</h3>
                            <p class="text-muted">Uptime</p>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-primary" id="version">v0.6.0-alpha</h3>
                            <p class="text-muted">Version</p>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-warning" id="environment">Production</h3>
                            <p class="text-muted">Environment</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-database"></i> Data Statistics</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-primary" id="totalAthletes">0</h3>
                            <p class="text-muted">Total Athletes</p>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-success" id="totalEvents">0</h3>
                            <p class="text-muted">Total Events</p>
                        </div>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-info" id="totalMatches">0</h3>
                            <p class="text-muted">Total Matches</p>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="text-center">
                            <h3 class="text-warning" id="lastUpdate">Never</h3>
                            <p class="text-muted">Last Update</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-list"></i> System Logs</h5>
            </div>
            <div class="card-body">
                <div id="systemLogs" style="max-height: 300px; overflow-y: auto;">
                    <div class="log-entry">
                        <span class="text-muted">[2024-01-01 12:00:00]</span>
                        <span class="text-info">INFO</span>
                        <span>System started successfully</span>
                    </div>
                    <div class="log-entry">
                        <span class="text-muted">[2024-01-01 12:00:01]</span>
                        <span class="text-success">INFO</span>
                        <span>Database connection established</span>
                    </div>
                    <div class="log-entry">
                        <span class="text-muted">[2024-01-01 12:00:02]</span>
                        <span class="text-success">INFO</span>
                        <span>Web server listening on port 8000</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Update system status
    updateSystemStatus();
    
    // Update every 30 seconds
    setInterval(updateSystemStatus, 30000);
});

function updateSystemStatus() {
    // Simulate system status update
    const now = new Date();
    const uptime = Math.floor((now.getTime() - new Date(now.getTime() - 3600000).getTime()) / 1000 / 60);
    const hours = Math.floor(uptime / 60);
    const minutes = uptime % 60;
    
    document.getElementById('uptime').textContent = `${hours}h ${minutes}m`;
    document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
    
    // Load data statistics
    loadDataStatistics();
}

async function loadDataStatistics() {
    try {
        // Load athletes count
        const athletesResponse = await fetch('/api/athletes');
        if (athletesResponse.ok) {
            const athletesData = await athletesResponse.json();
            document.getElementById('totalAthletes').textContent = athletesData.length || 0;
        }
        
        // Load events count
        const eventsResponse = await fetch('/api/events');
        if (eventsResponse.ok) {
            const eventsData = await eventsResponse.json();
            document.getElementById('totalEvents').textContent = eventsData.length || 0;
        }
        
        // Load matches count (placeholder)
        document.getElementById('totalMatches').textContent = '0';
        
    } catch (error) {
        console.error('Error loading data statistics:', error);
    }
}
</script>

<style>
.log-entry {
    padding: 2px 0;
    font-family: monospace;
    font-size: 0.9em;
}
</style>
{% endblock %} 